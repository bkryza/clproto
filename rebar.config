{deps, [
    {gpb, ".*", {git, "https://github.com/tomas-abrahamsson/gpb.git", {tag, "485dceecd7"}}}
]}.

{erl_opts, [
    fail_on_warning
]}.

{pre_hooks, [
    {compile, "mkdir -p include"},
    {compile, "./deps/gpb/bin/protoc-erl -il -strbin -I`pwd`/proto "
    "-o-erl src -o-hrl include `pwd`/proto/*.proto"}
]}.

{post_hooks, [
    {clean,
        "sh -c 'for f in proto/*.proto; "
        "do "
        "  rm -f src/$(basename $f .proto).erl; "
        "  rm -f include/$(basename $f .proto).hrl; "
        "done'"
    }
]}.
